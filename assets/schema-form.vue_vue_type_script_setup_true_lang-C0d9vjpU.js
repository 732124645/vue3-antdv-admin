import{c as F,u as e,p as De,i as Ee,d as ae,k as D,F as se,I as We,a as fe,G as le,_ as q,w as ue,m as Ke,A as Ne,W as T,X as V,Y as K,au as z,af as te,a5 as he,Z as U,a6 as ye,ak as oe,ad as G,ag as qe,am as ge,ae as ie,y as Ge,aw as Ue,ac as ze,ah as He,f as ke,r as me,J as Ye,K as Je,av as pe,H as Xe,ax as Ze}from"./vue-Dbi1xauY.js";import{aO as be,ax as C,K as xe,aP as Qe,i as $,aQ as J,aR as ne,ai as de,aS as et,af as tt,aa as ve,S as nt,aT as Te,aU as st,ar as ot,D as at,aV as H,aW as Be,aX as Oe,aY as rt,aZ as Ie,a_ as ct,a$ as lt}from"./antdv-CAXihDg_.js";import{c as it,s as ut,a as dt,b as ft,d as mt}from"./ApiSelect.vue_vue_type_script_setup_true_lang-IWTYr-Fy.js";import{h as Se,_ as _e}from"./index-DWJF4vuV.js";import{i as X}from"./is-C0dFuREE.js";import{d as Le}from"./index-CCwlABZW.js";import{d as Ce}from"./dateUtil-NBcmMhwL.js";function pt(c,g){return F(()=>{const o=e(c),{labelCol:y={},wrapperCol:v={}}=o.formItemProps||{},{labelWidth:m,disabledLabelWidth:R}=o,{labelWidth:A,labelCol:M,wrapperCol:O}=e(g);if(!A&&!m&&!M||R)return y.style={textAlign:"left"},{labelCol:y,wrapperCol:v};let x=m||A;const i={...M,...y},k={...O,...v};return x&&(x=be(x)?`${x}px`:x),{labelCol:{style:{width:x},...i},wrapperCol:{style:{width:`calc(100% - ${x})`},...k}}})}function Me(c,g=""){const{t:o}=Se();if(c.includes("Input")||c.includes("Complete"))return`${o("common.inputText")}${g}`;const y=["Select","Cascader","Checkbox","CheckboxGroup","Switch","TreeSelect"];return c.includes("Picker")||y.includes(c)?`${o("common.chooseText")}${g}`:""}const ht=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function yt(){return[...ht,"RangePicker"]}function gt(c,g){return c&&["Input","InputPassword","InputSearch","InputTextArea"].includes(c)&&g&&be(g)?`${g}`:g}const bt=yt(),je=Symbol("schema-form");async function vt(c){De(je,c)}function $e(c={}){return Ee(je,c)}const St={formModel:{type:Object,default:()=>({})},schema:{type:Object,default:()=>({})},tableInstance:{type:Object},tableRowKey:{type:[String,Number]}};function wt(c,g="default",o){if(!c||!Reflect.has(c,g))return null;if(!C(c[g]))return console.error(`${g} is not a function!`),null;const y=c[g];return y?y(o):null}const At={maxWidth:{type:String,default:"600px"},showIndex:{type:Boolean},color:{type:String,default:"#ffffff"},fontSize:{type:String,default:"14px"},placement:{type:String,default:"right"},text:{type:[Array,String]}},Pt=ae({name:"BasicHelp",components:{Tooltip:xe},props:At,setup(c,{slots:g}){const o=F(()=>({color:c.color,fontSize:c.fontSize})),y=F(()=>({maxWidth:c.maxWidth}));function v(){const m=c.text;return $(m)?D("p",null,[m]):J(m)?m.map((R,A)=>D("p",{key:R},[D(se,null,[c.showIndex?`${A+1}. `:"",R])])):null}return()=>D(xe,{overlayClassName:"basic-help__wrap",title:D("div",{style:e(o)},[v()]),autoAdjustOverflow:!0,overlayStyle:e(y),placement:c.placement},{default:()=>[D("span",{class:"basic-help"},[wt(g)||D(Qe,null,null)])]})}}),Rt={class:"mr-[6px]"},Ft={class:"ml-[6px]"},kt=ae({name:"SchemaFormItem",__name:"schema-form-item",props:St,emits:["update:formModel"],setup(c,{emit:g}){const o=c,y=g,v=$e(),{formPropsRef:m,setItemRef:R,updateSchema:A,getSchemaByFiled:M,appendSchemaByField:O}=v,{t:x}=Se(),{schema:i}=We(o),k=pt(i,m),d=F(()=>J(i.value.field)?i.value.field:i.value.field.split(".")),r=F({get(){return d.value.reduce((t,n)=>t==null?void 0:t[n],o.formModel)},set(t){const n=i.value.field.split("."),s=n.pop(),l=n.reduce((S,f)=>S[f]??(S[f]={}),o.formModel);l[s]=t,y("update:formModel",o.formModel)}}),p=F(()=>{const{component:t,componentProps:n}=i.value;if(!C(n)&&(n!=null&&n.vModelKey))return n.vModelKey;const s=$(t)&&["Switch","Checkbox"].includes(t),l=t==="Upload";return{true:"value",[`${s}`]:"checked",[`${l}`]:"file-list"}.true}),h=F(()=>{const{formModel:t,schema:n,tableInstance:s}=o,{mergeDynamicData:l}=e(m);return{field:n.field,formInstance:v,tableInstance:s,tableRowKey:o.tableRowKey,formModel:o.tableRowKey?t[o.tableRowKey]:t,values:{...l,...t},schema:F(()=>o.schema)}}),B=F(()=>{const{vShow:t,vIf:n,isAdvanced:s=!1}=e(i),{showAdvancedButton:l}=e(m),S=l&&ne(s)?s:!0;let f=!0,_=!0;return ne(t)&&(f=t),ne(n)&&(_=n),C(t)&&(f=t(e(h))),C(n)&&(_=n(e(h))),f=f&&S,{isShow:f,isIfShow:_}}),b=F(()=>{const{disabled:t}=e(m),{dynamicDisabled:n}=o.schema,{disabled:s=!1}=e(j);let l=!!t||s;return ne(n)&&(l=n),C(n)&&(l=n(e(h))),l}),I=(t,n=e(h))=>{if($(t))return D(se,null,[t]);if(fe(t))return t;if(C(t))return I(t(n));if(t&&X(t)){const s=Object.keys(t);return s.some(l=>l.startsWith("_")||["setup","render"].includes(l))?t:s.reduce((l,S)=>(l[S]=(...f)=>I(t[S],...f),l),{})}return t},w=F(()=>{const t=o.schema.component;return $(t)?it[t]??I(t):I(t)}),E=F(()=>{const t=o.schema.componentSlots??{};return $(t)||fe(t)?{default:(...n)=>I(t,n)}:I(t)}),L=F(()=>{const t=o.schema.label;return C(t)?t(e(h)):t}),j=F(()=>{const{schema:t}=o;let{componentProps:n={},component:s}=t;return C(n)&&(n=n(e(h))??{}),s!=="RangePicker"&&$(s)&&(n.placeholder??(n.placeholder=Me(s,L.value))),t.component==="Divider"&&(n=Object.assign({type:"horizontal"},n,{orientation:"left",plain:!0})),fe(w.value)&&Object.assign(n,w.value.props),n}),Q=F(()=>{var n;const t=((n=o.schema)==null?void 0:n.componentProps)||{};return Object.keys(t).reduce((s,l)=>{if(/on([A-Z])/.test(l)){const S=l.replace(/on([A-Z])/,"$1").toLocaleLowerCase();s[S]=t[l]}return s},{})}),Z=F(()=>{const{helpMessage:t,helpComponentProps:n,subLabel:s}=o.schema,l=s?D("span",null,[L.value,le(" "),D("span",{class:"text-secondary"},[s])]):I(L.value),S=C(t)?t(e(h)):t;return!S||Array.isArray(S)&&S.length===0?l:D("span",null,[l,D(Pt,q({placement:"top",class:"mx-1",text:S},n),null)])});function we(t,n,s){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(n)?t.type=s?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(n)?t.type="array":["InputNumber"].includes(n)&&(t.type="number")}const a=F(()=>{var Fe;const{rules:t=[],component:n,rulesMessageJoinLabel:s,dynamicRules:l,required:S}=o.schema;if(C(l))return l(e(h));let f=de(t);const{rulesMessageJoinLabel:_}=e(m),re=Reflect.has(e(m),"rulesMessageJoinLabel")?s:_,Ae=$(n)?`${Me(n,L.value)}${re?L.value:""}`:void 0;function Ve(N,W){const ce=N.message||Ae;return W===void 0||st(W)||Array.isArray(W)&&W.length===0||typeof W=="string"&&W.trim()===""||typeof W=="object"&&Reflect.has(W,"checked")&&Reflect.has(W,"halfChecked")&&Array.isArray(W.checked)&&Array.isArray(W.halfChecked)&&W.checked.length===0&&W.halfChecked.length===0?Promise.reject(ce):Promise.resolve()}const Pe=C(S)?S(e(h)):S;(!f||f.length===0)&&Pe&&(f=[{required:Pe,validator:Ve}]);const Re=f.findIndex(N=>Reflect.has(N,"required")&&!Reflect.has(N,"validator"));if(Re!==-1){const N=f[Re];if(n&&$(n)){Reflect.has(N,"type")||(N.type=n==="InputNumber"?"number":"string"),N.message=N.message||Ae,(n.includes("Input")||n.includes("Textarea"))&&(N.whitespace=!0);const W=(Fe=e(j))==null?void 0:Fe.valueFormat;we(N,n,W)}}const ee=f.findIndex(N=>N.max);return ee!==-1&&!f[ee].validator&&(f[ee].message=f[ee].message||x("component.form.maxTip",[f[ee].max])),f}),u=async t=>{try{const n=Object.assign(i.value,{loading:!0,componentProps:{...e(j),options:[]}});A(n);const s=await t(e(h)),{component:l}=e(i),S=n.componentProps;["Select","RadioGroup","CheckBoxGroup"].some(f=>f===l)?S.options=s:["TreeSelect","Tree"].some(f=>f===l)&&(S.treeData=s),n.componentProps&&(n.componentProps.requestResult=s),n.loading=!1,A(n)}finally{await Ge(),i.value.loading=!1}},P=()=>{const t=j.value.request;if(t)if(C(t))u(t);else{const{watchFields:n=[],options:s={},wait:l=0,callback:S}=t,f=n.map(_=>()=>o.formModel[_]);ue(f,ot(()=>{u(S)},l),{...s})}};return ue(B,(t,n)=>{!et(t,n)&&t.isIfShow&&t.isShow&&(M(o.schema.field)||O(o.schema),P())},{immediate:!0}),(t,n)=>B.value.isIfShow?Ke((T(),V(e(Te),z(q({key:0},e(i).colProps)),{default:K(()=>[e(i).component==="Divider"?(T(),V(e(tt),z(q({key:0},Object.assign(j.value))),{default:K(()=>[(T(),V(te(Z.value)))]),_:1},16)):(T(),V(e(ve).Item,q({key:1},{...e(i).formItemProps},{label:Z.value,name:d.value,"label-col":e(k).labelCol,"wrapper-col":e(k).wrapperCol,rules:a.value}),{default:K(()=>[e(i).beforeSlot?(T(),he(se,{key:0},[e($)(e(i).beforeSlot)?U(t.$slots,e(i).beforeSlot,z(q({key:0},h.value)),()=>[ye("span",Rt,oe(e(i).beforeSlot),1)],!0):G("",!0),e(C)(e(i).beforeSlot)?(T(),V(te(e(i).beforeSlot(h.value)),{key:1})):G("",!0)],64)):G("",!0),e(i).slot?U(t.$slots,e(i).slot,z(q({key:1},h.value)),void 0,!0):w.value?(T(),V(te(w.value),q({key:2,ref:e(R)(e(i).field)},j.value,{[p.value]:r.value,["onUpdate:"+p.value]:n[0]||(n[0]=s=>r.value=s),"allow-clear":!0,disabled:b.value,loading:e(i).loading},qe(Q.value)),ge({_:2},[Object.is(e(i).loading,!0)?{name:"notFoundContent",fn:K(()=>[D(e(nt),{size:"small"})]),key:"0"}:void 0,ie(E.value,(s,l)=>({name:l,fn:K(S=>[(T(),V(te((s==null?void 0:s({...h.value,slotData:S}))??s),{key:l}))])}))]),1040,["disabled","loading"])):G("",!0),e(i).afterSlot?(T(),he(se,{key:3},[e($)(e(i).afterSlot)?U(t.$slots,e(i).afterSlot,z(q({key:0},h.value)),()=>[ye("span",Ft,oe(e(i).afterSlot),1)],!0):G("",!0),e(C)(e(i).afterSlot)?(T(),V(te(e(i).afterSlot(h.value)),{key:1})):G("",!0)],64)):G("",!0)]),_:3},16,["label","name","label-col","wrapper-col","rules"]))]),_:3},16)),[[Ne,B.value.isShow]]):G("",!0)}}),xt=_e(kt,[["__scopeId","data-v-bff590e6"]]),Bt=ae({__name:"index",props:{expand:{type:Boolean}},setup(c){Ue(y=>({"4cf09dcc":o.value}));const g=c,o=F(()=>`${g.expand?0:.5}turn`);return(y,v)=>(T(),V(e(at),{class:"collapse-icon"}))}}),It=_e(Bt,[["__scopeId","data-v-af0a3cde"]]),Ct=ae({name:"FormAction",inheritAttrs:!1,__name:"form-action",props:{showActionButtonGroup:{type:Boolean,default:!0},showResetButton:{type:Boolean,default:!0},showSubmitButton:{type:Boolean,default:!0},showAdvancedButton:{type:Boolean,default:!0},resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:{type:Number,default:6},isAdvanced:Boolean,hideAdvanceBtn:Boolean},emits:["toggle-advanced"],setup(c,{emit:g}){const o=g,y=c,{t:v}=Se(),{resetFields:m,submit:R}=$e(),A=F(()=>{const{showAdvancedButton:k,actionSpan:d,actionColOptions:r}=y,p=24-d,h=k?{span:p<6?24:p}:{};return{style:{textAlign:"right"},span:k?6:4,...h,...r}}),M=F(()=>Object.assign({text:v("common.resetText")},y.resetButtonOptions)),O=F(()=>Object.assign({text:v("common.queryText")},y.submitButtonOptions));function x(){o("toggle-advanced",y.isAdvanced)}const i=async k=>{await R(k).catch(()=>{})};return(k,d)=>{const r=ze("a-button");return c.showActionButtonGroup?(T(),V(e(Te),z(q({key:0},A.value)),{default:K(()=>[ye("div",{style:He([{width:"100%"},{textAlign:A.value.style.textAlign}])},[D(e(ve).Item,null,{default:K(()=>[U(k.$slots,"resetBefore"),c.showResetButton?(T(),V(r,q({key:0,type:"default",class:"mr-2"},M.value,{onClick:e(m)}),{default:K(()=>[le(oe(M.value.text),1)]),_:1},16,["onClick"])):G("",!0),U(k.$slots,"submitBefore"),c.showSubmitButton?(T(),V(r,q({key:1,type:"primary",class:"mr-2"},O.value,{onClick:d[0]||(d[0]=p=>i(p))}),{default:K(()=>[le(oe(O.value.text),1)]),_:1},16)):G("",!0),U(k.$slots,"advanceBefore"),c.showAdvancedButton&&!c.hideAdvanceBtn?(T(),V(r,{key:2,type:"link",size:"small",onClick:x},{default:K(()=>[le(oe(c.isAdvanced?e(v)("component.form.putAway"):e(v)("component.form.unfold"))+" ",1),D(e(It),{class:"ml-1",expand:!c.isAdvanced},null,8,["expand"])]),_:1})):G("",!0),U(k.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):G("",!0)}}}),Mt=({props:c,attrs:g})=>{const o=ke(de(c)),y=me({...c.initialValues}),v=me({...c.initialValues}),m=ke(),R={...c.initialValues},A=new Map,M=new Map,O=me({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),x=F(()=>({...g,...o.value})),i=F(()=>{const{baseRowStyle:d={},rowProps:r}=e(x);return{style:d,...r}}),k=F(()=>({...x.value,...O}));return ue(()=>o.value.schemas,()=>{var d;(d=o.value.schemas)==null||d.forEach(r=>{!M.has(r.field)&&C(r.componentProps)&&M.set(r.field,r.componentProps),H(v,r.field,r.defaultValue)})}),{formModel:y,defaultFormValues:v,schemaFormRef:m,formPropsRef:o,cacheFormModel:R,compRefMap:A,getFormProps:x,advanceState:O,getRowConfig:i,getFormActionBindProps:k,originComponentPropsFnMap:M,formSchemasRef:F(()=>e(o).schemas||[])}};function Tt(c){const{emit:g,formPropsRef:o,formSchemasRef:y,formModel:v,cacheFormModel:m,getFormProps:R,schemaFormRef:A,defaultFormValues:M,originComponentPropsFnMap:O,handleFormValues:x}=c;function i(){return e(A)?x(Ye(e(v))):{}}function k(a){var u;return(u=e(o).schemas)==null?void 0:u.some(P=>P.field===a&&$(P.component)?bt.includes(P.component):!1)}async function d(a){const u=e(y),P=u.map(n=>n.field).filter(Boolean);Object.assign(m,a);const t=[];Object.entries(a).forEach(([n,s])=>{const l=u.find(f=>f.field===n),S=Reflect.has(a,n);if($(l==null?void 0:l.component)&&(s=gt(l==null?void 0:l.component,s)),S&&P.includes(n)){if(k(n))if(Array.isArray(s)){const f=[];for(const _ of s)f.push(_?Be(_):null);H(v,n,f)}else{const{componentProps:f}=l||{};let _=f;C(f)&&(_=_({formPropsRef:o,formModel:v})),H(v,n,s?_!=null&&_.valueFormat?s:Be(s):null)}else H(v,n,s);t.push(n)}}),await E(t).catch(n=>{})}async function r(a){let u=[];X(a)&&u.push(a),J(a)&&(u=[...a]),e(o).schemas=u}async function p(a,u,P=!1){const t=de(e(y)),n=t.findIndex(s=>s.field===u);if(!u||n===-1||P){P?t.unshift(a):t.push(a),o.value.schemas=t;return}n!==-1&&t.splice(n+1,0,a),o.value.schemas=t,I(o.value.schemas)}async function h(a){const u=de(e(y));if(!a)return;let P=$(a)?[a]:a;$(a)&&(P=[a]);for(const t of P)if($(t)){const n=u.findIndex(s=>s.field===t);n!==-1&&(Oe(v,t),u.splice(n,1))}o.value.schemas=u}function B(a){const u=e(y),P=[].concat(a);return u.find(t=>P.includes(t.field))}const b=a=>{let u=[];if(X(a)&&u.push(a),J(a)&&(u=[...a]),!u.every(s=>s.component==="Divider"||Reflect.has(s,"field")&&s.field)){console.error("All children of the form Schema array that need to be updated must contain the `field` field");return}const t=[],n=[];e(y).forEach(s=>{const l=u.find(S=>s.field===S.field);if(l){const S=l.componentProps,f=Le(s,l);if(O.has(s.field)){const _=O.get(s.field);f.componentProps=re=>({..._(re),...C(S)?S(re):S})}n.push(f),t.push(f)}else t.push(s)}),I(n),o.value.schemas=rt(t,"field")};function I(a){let u=[];X(a)&&u.push(a),J(a)&&(u=[...a]);const P={},t=i();u.forEach(n=>{n.component!="Divider"&&Reflect.has(n,"field")&&n.field&&!Ie(n.defaultValue)&&(!(n.field in t)||Ie(t[n.field]))&&(P[n.field]=n.defaultValue)}),d(P)}async function w(){const{resetFunc:a,submitOnReset:u}=e(R);a&&C(a)&&await a(),Object.keys(v).forEach(P=>{H(v,P,M[P])}),g("reset",v),u&&Z(),setTimeout(j)}async function E(a){var u;return(u=A.value)==null?void 0:u.validateFields(a)}async function L(a){return await A.value.validate(a)}async function j(a){var u;await((u=A.value)==null?void 0:u.clearValidate(a))}async function Q(a,u){var P;await((P=A.value)==null?void 0:P.scrollToField(a,u))}async function Z(a){a&&a.preventDefault();const{submitFunc:u}=e(R);if(u&&C(u)){await u();return}if(e(A))try{const t=await L(),n=x(t);return g("submit",t),n}catch(t){return Promise.reject(t)}}return{submit:Z,handleEnterPress:a=>{const{autoSubmitOnEnter:u}=e(o);if(u&&a.key==="Enter"&&a.target&&a.target instanceof HTMLElement){const P=a.target;P&&P.tagName&&P.tagName.toUpperCase()=="INPUT"&&Z(a)}},clearValidate:j,validate:L,validateFields:E,getFieldsValue:i,updateSchema:b,resetSchema:r,getSchemaByFiled:B,appendSchemaByField:p,removeSchemaByField:h,resetFields:w,setFieldsValue:d,scrollToField:Q,setDefaultValue:I}}const Ot=c=>{const{compRefMap:g,formModel:o,formPropsRef:y,cacheFormModel:v,schemaFormRef:m,getFormProps:R}=c,A=d=>r=>{r&&g.set(d,r)},M=(d,r)=>{var h;H(o,d,r),H(v,d,r);const{validateTrigger:p}=e(R);(!p||p==="change")&&((h=m.value)==null||h.validateFields([d]))},O=d=>Oe(o,d),x=d=>{y.value=Le(e(y)||{},d)};function i(d){var p,h;if(!X(d))return{};const r={};for(const B of Object.entries(d)){let[,b]=B;const[I]=B;if(!I||J(b)&&b.length===0||C(b))continue;const w=e(R).transformDateFunc;X(b)&&(b=w==null?void 0:w(b)),J(b)&&((p=b[0])!=null&&p.format)&&((h=b[1])!=null&&h.format)&&(b=b.map(E=>w==null?void 0:w(E))),$(b)&&(b=b.trim()),H(r,I,b)}return k(r)}function k(d){const r=e(R).fieldMapToTime;if(!r||!Array.isArray(r))return d;for(const[p,[h,B],b="YYYY-MM-DD"]of r){if(!p||!h||!B||!d[p])continue;const[I,w]=d[p];d[h]=Ce(I).format(b),d[B]=Ce(w).format(b),Reflect.deleteProperty(d,p)}return d}return{setItemRef:A,setFormModel:M,delFormModel:O,setSchemaFormProps:x,handleFormValues:i}};let _t,Lt,jt;function $t(){return{screenRef:F(()=>e(_t)),widthRef:Lt,screenEnum:ut,realWidthRef:jt}}const Y=24,Vt=({instance:c,emit:g})=>{const{realWidthRef:o,screenEnum:y,screenRef:v}=$t(),{advanceState:m,getFormProps:R,formSchemasRef:A,formModel:M,defaultFormValues:O}=c,x=F(()=>{if(!m.isAdvanced)return 0;const r=e(R).emptySpan||0;if(be(r))return r;if(X(r)){const{span:p=0}=r,h=e(v);return r[h.toLowerCase()]||p||0}return 0});ue([A,()=>m.isAdvanced,()=>e(o)],()=>{const{showAdvancedButton:r}=e(R);r&&k()},{immediate:!0});function i(r,p=0,h=!1){const B=e(o),b=parseInt(r.md)||parseInt(r.xs)||parseInt(r.sm)||r.span||Y,I=parseInt(r.lg)||b,w=parseInt(r.xl)||I,E=parseInt(r.xxl)||w;return B<=y.LG?p+=b:B<y.XL?p+=I:B<y.XXL?p+=w:p+=E,h?(m.hideAdvanceBtn=!1,p<=Y*2?(m.hideAdvanceBtn=!0,m.isAdvanced=!0):p>Y*2&&p<=Y*(e(R).autoAdvancedLine||3)?m.hideAdvanceBtn=!1:m.isLoad||(m.isLoad=!0,m.isAdvanced=!m.isAdvanced),{isAdvanced:m.isAdvanced,itemColSum:p}):p>Y*(e(R).alwaysShowLines||1)?{isAdvanced:m.isAdvanced,itemColSum:p}:{isAdvanced:!0,itemColSum:p}}function k(){let r=0,p=0;const{baseColProps:h={}}=e(R);for(const B of e(A)){const{vShow:b,colProps:I}=B;let w=!0;if(ne(b)&&(w=b),C(b)&&(w=b({schema:F(()=>e(A).find(E=>E.field===B.field)),formModel:M,field:B.field,formInstance:c,values:{...e(O),...M}})),w&&(I||h)){const{itemColSum:E,isAdvanced:L}=i({...h,...I},r);r=E||0,L&&(p=r),B.isAdvanced=L}}m.actionSpan=p%Y+e(x),i(e(R).actionColOptions||{span:Y},r,!0),g("advanced-change")}function d(){m.isAdvanced=!m.isAdvanced}return{handleToggleAdvanced:d}},Ut=ae({name:"SchemaForm",__name:"schema-form",props:dt,emits:ft,setup(c,{expose:g,emit:o}){const y=c,v=o,m=Je(),R=Mt({props:y,attrs:m}),{formModel:A,getRowConfig:M,schemaFormRef:O,getFormProps:x,getFormActionBindProps:i,formSchemasRef:k}=R,d=Ot({...R}),{handleFormValues:r}=d,p=Tt({...R,emit:v,handleFormValues:r}),{handleEnterPress:h,setDefaultValue:B}=p,b={...R,...p,...d},{handleToggleAdvanced:I}=Vt({instance:b,emit:v});return v("register",b),vt(b),g(b),B(k.value),(w,E)=>(T(),V(e(ve),q({ref_key:"schemaFormRef",ref:O},e(lt)(e(x),e(mt)),{model:e(A),onKeypress:Ze(e(h),["enter"])}),{default:K(()=>[D(e(ct),z(pe(e(M))),{default:K(()=>[U(w.$slots,"formHeader"),U(w.$slots,"default",{},()=>[(T(!0),he(se,null,ie(e(k),L=>(T(),V(xt,{key:L.field,"form-model":e(A),"onUpdate:formModel":E[0]||(E[0]=j=>Xe(A)?A.value=j:null),schema:L,"table-instance":w.tableInstance},ge({_:2},[ie(Object.keys(w.$slots),j=>({name:j,fn:K(Q=>[U(w.$slots,j,z(pe(Q||{})))])}))]),1032,["form-model","schema","table-instance"]))),128)),w.showActionButtonGroup?(T(),V(Ct,q({key:0},e(i),{onToggleAdvanced:e(I)}),ge({_:2},[ie(["resetBefore","submitBefore","advanceBefore","advanceAfter"],L=>({name:L,fn:K(j=>[U(w.$slots,L,z(pe(j||{})))])}))]),1040,["onToggleAdvanced"])):G("",!0)]),U(w.$slots,"formFooter")]),_:3},16)]),_:3},16,["model","onKeypress"]))}});export{xt as S,Ut as _,Pt as a,St as s};
