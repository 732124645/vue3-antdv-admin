import{f as z}from"./index-CCwlABZW.js";import{A as g,G as C}from"./index-DWJF4vuV.js";import{f as F}from"./dateUtil-NBcmMhwL.js";import{aN as R,e as T,S as V,a0 as I,aq as J,Q as A,L,W as P}from"./antdv-CAXihDg_.js";import{d as q,f as t,c as S,W as y,X as E,Y as l,k as s,u as e,ah as N,a5 as W,ae as U,F as H,G as k,y as j,ac as X,ak as O}from"./vue-Dbi1xauY.js";const Z="data:image/png;base64,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",ae=q({name:"FilePreviewDrawer",__name:"file-preview-drawer",setup(G,{expose:B}){const d=new Map([["name","文件名"],["mimeType","文件类型"],["hash","文件Hash"],["md5","文件MD5"],["fsize","文件大小"],["putTime","上传时间"],["uploader","上传人员"]]),m=t(!1),f=t(!1),w=t(""),h=t(""),n=t({}),r=t(""),u=t(""),M=t(!1),c=S(()=>R(r.value)),Q=S(()=>`${r.value}?imageView2/2/w/500/h/210`),x=async(i,p)=>{f.value=!0,w.value=i,h.value=p,await j();try{m.value=!0;const v={name:i,path:p},a=await g.netDiskManage.netDiskManageInfo(v);if(u.value=a.mark,Array.from(d.keys()).forEach(o=>{o==="fsize"?n.value.fsize=z(a[o]):n.value[o]=a[o]}),n.value.putTime=F(a.putTime),n.value.name=i,n.value,C("netdisk:manage:download")&&a.mimeType.includes("image/")){const o=await g.netDiskManage.netDiskManageDownload(v);r.value=o}}catch{D()}finally{m.value=!1}},b=async()=>{try{M.value=!0,await g.netDiskManage.netDiskManageMark({name:w.value,path:h.value,mark:u.value}),T.success("已更新文件备注")}finally{M.value=!1}},D=()=>{w.value="",h.value="",r.value="",u.value="",n.value={},f.value=!1};return B({open:x}),(i,p)=>{const v=X("a-button");return y(),E(e(P),{title:"文件详情",width:500,visible:f.value,onClose:D},{default:l(()=>[s(e(V),{spinning:m.value,class:"preview-drawer-inner-box"},{default:l(()=>[s(e(I),{direction:"vertical"},{default:l(()=>[s(e(J),{style:N({width:c.value?"130px":"100%",height:c.value?"85px":"210px"}),src:c.value?e(Z):Q.value,preview:c.value?!1:{src:r.value}},null,8,["style","src","preview"]),s(e(A),{bordered:"",column:1,size:"small"},{default:l(()=>[(y(!0),W(H,null,U(e(d).keys(),a=>(y(),E(e(A).Item,{key:a,label:e(d).get(a),"label-style":{whiteSpace:"nowrap"}},{default:l(()=>[k(O(n.value[a]),1)]),_:2},1032,["label"]))),128)),s(e(A).Item,{label:"文件备注","label-style":{whiteSpace:"nowrap"}},{default:l(()=>[s(e(I),{direction:"vertical",align:"end"},{default:l(()=>[s(e(L).TextArea,{value:u.value,"onUpdate:value":p[0]||(p[0]=a=>u.value=a),disabled:!i.$auth("netdisk:manage:mark"),placeholder:"请输入文件备注",maxlength:100,rows:4,"show-count":""},null,8,["value","disabled"]),s(v,{loading:M.value,disabled:!i.$auth("netdisk:manage:mark"),type:"primary",size:"mini",onClick:b},{default:l(()=>[k("更新 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible"])}}});export{ae as _};
