import{d as T,$ as V,f as c,az as x,o as D,W as S,a5 as g,k as f,Y as b,G as k,u as y,ac as N}from"./vue-Dbi1xauY.js";import{g as P,b as A}from"./columns-4eY50L7w.js";import{u as $}from"./dynamic-table-DhiAq_hs.js";import{A as i}from"./index-DWJF4vuV.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-IWTYr-Fy.js";import"./antdv-CAXihDg_.js";import"./index.vue_vue_type_style_index_0_lang-Dww9ZzaR.js";import{u as q}from"./useFormModal-DGpV1vZs.js";import{u as M}from"./tabsView-uVCHTdnS.js";import"./dateUtil-NBcmMhwL.js";import"./schema-form.vue_vue_type_script_setup_true_lang-C0d9vjpU.js";import"./is-C0dFuREE.js";import"./index-CCwlABZW.js";import"./useModal-BsEyE0vB.js";const F=(n,a)=>[{field:"typeId",component:"Select",label:"所属字典类型",rules:[{required:!0,type:"number"}],defaultValue:a,componentProps:{options:n,disabled:!0}},{field:"label",component:"Input",label:"字典项名称",rules:[{required:!0,type:"string"}]},{field:"value",component:"Input",label:"字典项值",rules:[{required:!0,type:"string"}]},{field:"orderNo",component:"InputNumber",label:"排序",defaultValue:0,componentProps:{style:{width:"100%"}}},{field:"status",label:"状态",component:"RadioGroup",defaultValue:1,componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}},{field:"remark",component:"InputTextArea",label:"备注",colProps:{span:24}}],X=T({name:"SystemDictItem",__name:"index",async setup(n){let a,m;const h=M(),p=V(),o=c(Number(p.params.id)),r=c([]),d=([a,m]=x(()=>i.systemDictType.dictTypeGetAll()),a=await a,m(),a);r.value=d.map(e=>({label:e.name,value:e.id,code:e.code})),D(()=>{const e=d.find(t=>t.id===o.value);h.updateTabTitle(`${p.meta.title}(${e==null?void 0:e.name})`)});const[I,s]=$({formProps:{schemas:P(r.value,_),initialValues:{typeId:o.value},onReset(e){Number.isInteger(e==null?void 0:e.typeId)&&(o.value=e.typeId)}}}),[v]=q(),u=async e=>{const[t]=await v({modalProps:{title:`${e.id?"编辑":"新增"}字典项`,width:"50%",onFinish:async l=>{e.id?await i.systemDictItem.dictItemUpdate({id:e.id},l):await i.systemDictItem.dictItemCreate(l),s==null||s.reload()}},formProps:{labelWidth:120,schemas:F(r.value,o.value)}});t==null||t.setFieldsValue({...e})},w=async e=>{await i.systemDictItem.dictItemDelete({id:e.id}),s==null||s.reload()};function _(e){o.value=e}const C=[...A,{title:"操作",width:130,dataIndex:"ACTION",hideInSearch:!0,fixed:"right",actions:({record:e})=>[{label:"编辑",auth:{perm:"system:dict-item:update",effect:"disable"},onClick:()=>u(e)},{label:"删除",auth:"system:dict-item:delete",popConfirm:{title:"你确定要删除吗？",placement:"left",onConfirm:()=>w(e)}}]}];return(e,t)=>{const l=N("a-button");return S(),g("div",null,[f(y(I),{"row-key":"id","header-title":"字典项管理","data-request":y(i).systemDictItem.dictItemList,columns:C,bordered:"",size:"small","search-params":{typeId:o.value}},{toolbar:b(()=>[f(l,{type:"primary",disabled:!e.$auth("system:dict-item:create"),onClick:t[0]||(t[0]=B=>u({}))},{default:b(()=>[k(" 新增 ")]),_:1},8,["disabled"])]),_:1},8,["data-request","search-params"])])}}});export{X as default};
