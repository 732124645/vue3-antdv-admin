import{d as g,f as w,c as k,k as s,u as E,a as L,F as M,x as j}from"./vue-Dbi1xauY.js";import{I as D}from"./index-DWJF4vuV.js";import{x as b,y as O}from"./antdv-CAXihDg_.js";import{b as P}from"./is-C0dFuREE.js";function S(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!L(e)}const _={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},x=e=>{const{item:o}=e;return s("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,o)},[e.showIcon&&o.icon&&s(D,{class:"mr-2",type:o.icon},null),s("span",null,[o.label])])},$=g({name:"ContextMenu",props:_,setup(e,{expose:o}){const y=w(!0),r=k(()=>{const{axis:l,items:t,styles:n,width:i}=e,{x:c,y:d}=l||{x:0,y:0},v=(t||[]).length*40,p=i,h=document.body,I=h.clientWidth<c+p?c-p:c,C=h.clientHeight<d+v?d-v:d;return{position:"absolute",width:`${i}px`,left:`${I+1}px`,top:`${C+1}px`,...n}}),a=()=>{y.value=!1};function u(l,t){const{handler:n,disabled:i}=l;i||(t==null||t.stopPropagation(),t==null||t.preventDefault(),n==null||n(),a())}function f(l){return l.filter(n=>!n.hidden).map(n=>{const{disabled:i,label:c,children:d,divider:v=!1}=n,p={item:n,handler:u,showIcon:e.showIcon};return!d||d.length===0?s(M,null,[s(b.Item,{disabled:i,key:c},{default:()=>[s(x,p,null)]}),v?s(b.Divider,{key:`d-${c}`},null):null]):s(b.SubMenu,{key:c,disabled:i},{title:()=>s(x,p,null),default:()=>f(d)})})}return o({close:a}),()=>{const{items:l}=e;return s(O,{open:y.value},{default:()=>s("div",{style:E(r)},null),overlay:()=>{let t;return s(b,{inlineIndent:12,mode:"vertical"},S(t=f(l))?t:{default:()=>[t]})}})}}}),m={domList:[],resolve:()=>{}},V=function(e){const{event:o}=e||{};if(o&&(o==null||o.preventDefault()),!!P)return new Promise(y=>{const r=document.body,a=document.createElement("div"),u={getPopupContainer:()=>a};e.styles&&(u.styles=e.styles),e.items&&(u.items=e.items),e.event&&(u.customEvent=o,u.axis={x:o.clientX,y:o.clientY});const f=s($,u);j(f,a);const l=function(){m.resolve("")};m.domList.push(a);const t=function(){m.domList.forEach(n=>{try{n&&r.removeChild(n)}catch{}}),r.removeEventListener("click",l),r.removeEventListener("scroll",l)};m.resolve=function(n){var i,c;(c=(i=f.component)==null?void 0:i.exposed)==null||c.close(),t(),y(n)},t(),r.appendChild(a),r.addEventListener("click",l),r.addEventListener("scroll",l)})},W=function(){m&&(m.resolve(""),m.domList=[])};export{V as c,W as d};
